<!DOCTYPE html>
<html>
<head>
    <title>XAUUSD Backtester</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: Arial; background:#0f172a; color:white; text-align:center; padding:40px; }
        h1 { color: gold; }
        select, input, button { margin:5px; padding:8px; border-radius:5px; font-size:14px;}
        button { background: gold; color:black; border:none; cursor:pointer;}
        button:hover { background:#ffd700; }
        #loading { margin-top:20px; display:none; }
        .result-box { margin-top:30px; background:#1e293b; padding:20px; border-radius:10px; display:inline-block; text-align:left; }
    </style>
</head>
<body>
    <h1>XAUUSD Backtester (API)</h1>

    <label>Interval:</label>
    <select id="interval">
        <option value="1min">1min</option>
        <option value="5min" selected>5min</option>
        <option value="15min">15min</option>
        <option value="60min">1H</option>
    </select>

    <label>Start Date:</label>
    <input type="date" id="start_date">

    <label>End Date:</label>
    <input type="date" id="end_date">

    <br><br>
    <button onclick="runBacktest()">Run Backtest</button>

    <div id="loading"><p>Running backtest... Please wait.</p></div>
    <div id="results"></div>

    <script>
        async function runBacktest(){
            document.getElementById("loading").style.display="block";
            document.getElementById("results").innerHTML="";

            const formData = new FormData();
            formData.append("interval", document.getElementById("interval").value);
            formData.append("start_date", document.getElementById("start_date").value);
            formData.append("end_date", document.getElementById("end_date").value);

            const response = await fetch("/backtest",{method:"POST", body: formData});
            const data = await response.json();

            document.getElementById("loading").style.display="none";

            if(data.error){
                document.getElementById("results").innerHTML="<p style='color:red;'>Error: "+data.error+"</p>";
                return;
            }

            document.getElementById("results").innerHTML=`
                <div class="result-box">
                    <h3>Backtest Results</h3>
                    <p><strong>Final Balance:</strong> $${data.final_balance}</p>
                    <p><strong>Total Trades:</strong> ${data.total_trades}</p>
                    <p><strong>Win Rate:</strong> ${data.win_rate}%</p>
                    <p><strong>Max Drawdown:</strong> $${data.max_drawdown}</p>
                </div>`;
        }
    </script>
</body>
</html>
